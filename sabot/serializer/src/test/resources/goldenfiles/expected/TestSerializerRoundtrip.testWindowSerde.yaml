#
# Copyright (C) 2017-2019 Dremio Corporation
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

---
 -
  description: "WINDOW function"
  input: "select sum(a) over(partition by b) as col1, count(*) over(partition by c) as col2 from t1"
  output:
    queryPlanBinary: "CjIKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIECgJUMQpZCih0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxQcm9qZWN0Ei0SAUESAUISAUMaChIICgQIARAEEAEaChIICgQIARAEEAIaChIICgQIARAEEAMKmAIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxLsAQgBGl4KAQEaBBoCCAEiBBoCCAIqAgoAMiNqIQoXCgIQBRIHCgVDT1VOVBoIEgYKBAgBEAQSBgoCGAEgAzIkaiIKFgoCEAUSBgoEU1VNMBoIEgYKBAgBEAQSBgoCGAEgAxgBGjAKAQIaBBoCCAEiBBoCCAIqAgoAMhtqGQoNCgIQBRIHCgVDT1VOVBIGCgIYASADGAIiVhAoSAJSCQoBQRoECAEQBFILCgFCEAEaBAgBEARSCwoBQxACGgQIARAEUg0KBXcwJG8wEAMaAhAFUg0KBXcwJG8xEAQaAhAFUg0KBXcxJG8wEAUaAhAFCp0BCih0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxQcm9qZWN0EnEIAhIEY29sMRIEY29sMhpXKlUKBAgBEAUSBgoEQ0FTRRovKi0KAhABEg4KDEdSRUFURVJfVEhBThoIEgYKAhAFEAMaDSILCgIQBRIDEgEAUAYaCBIGCgIQBRAEGgoiCAoECAEQBVAgGggSBgoCEAUQBQ=="
    queryPlanBinaryHexDump:
     - "00000000 0A 32 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .2.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 04 gicalTableScan.."
     - "00000030 0A 02 54 31 0A 59 0A 28 74 79 70 65 2E 67 6F 6F ..T1.Y.(type.goo"
     - "00000040 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E gleapis.com/plan"
     - "00000050 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 .PLogicalProject"
     - "00000060 12 2D 12 01 41 12 01 42 12 01 43 1A 0A 12 08 0A .-..A..B..C....."
     - "00000070 04 08 01 10 04 10 01 1A 0A 12 08 0A 04 08 01 10 ................"
     - "00000080 04 10 02 1A 0A 12 08 0A 04 08 01 10 04 10 03 0A ................"
     - "00000090 98 02 0A 27 74 79 70 65 2E 67 6F 6F 67 6C 65 61 ...'type.googlea"
     - "000000A0 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "000000B0 67 69 63 61 6C 57 69 6E 64 6F 77 12 EC 01 08 01 gicalWindow.ì..."
     - "000000C0 1A 5E 0A 01 01 1A 04 1A 02 08 01 22 04 1A 02 08 .^.........\"...."
     - "000000D0 02 2A 02 0A 00 32 23 6A 21 0A 17 0A 02 10 05 12 .*...2#j!......."
     - "000000E0 07 0A 05 43 4F 55 4E 54 1A 08 12 06 0A 04 08 01 ...COUNT........"
     - "000000F0 10 04 12 06 0A 02 18 01 20 03 32 24 6A 22 0A 16 ........ .2$j\".."
     - "00000100 0A 02 10 05 12 06 0A 04 53 55 4D 30 1A 08 12 06 ........SUM0...."
     - "00000110 0A 04 08 01 10 04 12 06 0A 02 18 01 20 03 18 01 ............ ..."
     - "00000120 1A 30 0A 01 02 1A 04 1A 02 08 01 22 04 1A 02 08 .0.........\"...."
     - "00000130 02 2A 02 0A 00 32 1B 6A 19 0A 0D 0A 02 10 05 12 .*...2.j........"
     - "00000140 07 0A 05 43 4F 55 4E 54 12 06 0A 02 18 01 20 03 ...COUNT...... ."
     - "00000150 18 02 22 56 10 28 48 02 52 09 0A 01 41 1A 04 08 ..\"V.(H.R...A..."
     - "00000160 01 10 04 52 0B 0A 01 42 10 01 1A 04 08 01 10 04 ...R...B........"
     - "00000170 52 0B 0A 01 43 10 02 1A 04 08 01 10 04 52 0D 0A R...C........R.."
     - "00000180 05 77 30 24 6F 30 10 03 1A 02 10 05 52 0D 0A 05 .w0$o0......R..."
     - "00000190 77 30 24 6F 31 10 04 1A 02 10 05 52 0D 0A 05 77 w0$o1......R...w"
     - "000001A0 31 24 6F 30 10 05 1A 02 10 05 0A 9D 01 0A 28 74 1$o0..........(t"
     - "000001B0 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 ype.googleapis.c"
     - "000001C0 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C om/plan.PLogical"
     - "000001D0 50 72 6F 6A 65 63 74 12 71 08 02 12 04 63 6F 6C Project.q....col"
     - "000001E0 31 12 04 63 6F 6C 32 1A 57 2A 55 0A 04 08 01 10 1..col2.W*U....."
     - "000001F0 05 12 06 0A 04 43 41 53 45 1A 2F 2A 2D 0A 02 10 .....CASE./*-..."
     - "00000200 01 12 0E 0A 0C 47 52 45 41 54 45 52 5F 54 48 41 .....GREATER_THA"
     - "00000210 4E 1A 08 12 06 0A 02 10 05 10 03 1A 0D 22 0B 0A N............\".."
     - "00000220 02 10 05 12 03 12 01 00 50 06 1A 08 12 06 0A 02 ........P......."
     - "00000230 10 05 10 04 1A 0A 22 08 0A 04 08 01 10 05 50 20 ......\".......P "
     - "00000240 1A 08 12 06 0A 02 10 05 10 05                   .........."
    queryPlanText:
     - "LogicalProject(col1=[CASE(>($3, 0), $4, null:BIGINT)], col2=[$5])"
     - "  LogicalWindow(window#0=[window(partition {1} order by [] range between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING aggs [COUNT($0), $SUM0($0)])], window#1=[window(partition {2} order by [] range between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING aggs [COUNT()])])"
     - "    LogicalProject(A=[$1], B=[$2], C=[$3])"
     - "      LogicalTableScan(table=[[T1]])"
 -
  description: "Calculate the Rank of Employees Based on Salary"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    DEPTNO, \n    SAL, \n    RANK() OVER (PARTITION BY DEPTNO ORDER BY SAL DESC) AS SALARY_RANK\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAK6wIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxK/Aho3CgEHGgQaAggBIgISACoKCggKBggFEAMYAjIcahoKDAoCEAUSBgoEUkFOSxIKCgIYARABGAEgAyKDAhAoSAJSDQoFRU1QTk8aBAgBEARSOwoFRU5BTUUQARowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xUjkKA0pPQhACGjAIARAdIAoqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSDQoDTUdSEAMaBAgBEARSFAoISElSRURBVEUQBBoGCAEQDSADUg0KA1NBTBAFGgQIARAEUg4KBENPTU0QBhoECAEQBFIQCgZERVBUTk8QBxoECAEQBFIRCgdTTEFDS0VSEAgaBAgBEAFSDQoFdzAkbzAQCRoCEAUKuwEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSjgEIARIFRU1QTk8SBUVOQU1FEgZERVBUTk8SA1NBTBILU0FMQVJZX1JBTksaCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAcaChIICgQIARAEEAUaCBIGCgIQBRAJ"
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A EB 02 0A 27 74 79 70 65 2E 67 ..EMP.ë..'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F an.PLogicalWindo"
     - "00000060 77 12 BF 02 1A 37 0A 01 07 1A 04 1A 02 08 01 22 w.¿..7.........\""
     - "00000070 02 12 00 2A 0A 0A 08 0A 06 08 05 10 03 18 02 32 ...*...........2"
     - "00000080 1C 6A 1A 0A 0C 0A 02 10 05 12 06 0A 04 52 41 4E .j...........RAN"
     - "00000090 4B 12 0A 0A 02 18 01 10 01 18 01 20 03 22 83 02 K.......... .\".."
     - "000000A0 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F 1A 04 08 .(H.R...EMPNO..."
     - "000000B0 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 01 1A 30 ...R;..ENAME...0"
     - "000000C0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "000000D0 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "000000E0 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "000000F0 52 39 0A 03 4A 4F 42 10 02 1A 30 08 01 10 1D 20 R9..JOB...0.... "
     - "00000100 0A 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 .*...ISO-8859-1$"
     - "00000110 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 en_US$primary(.2"
     - "00000120 0A 49 53 4F 2D 38 38 35 39 2D 31 52 0D 0A 03 4D .ISO-8859-1R...M"
     - "00000130 47 52 10 03 1A 04 08 01 10 04 52 14 0A 08 48 49 GR........R...HI"
     - "00000140 52 45 44 41 54 45 10 04 1A 06 08 01 10 0D 20 03 REDATE........ ."
     - "00000150 52 0D 0A 03 53 41 4C 10 05 1A 04 08 01 10 04 52 R...SAL........R"
     - "00000160 0E 0A 04 43 4F 4D 4D 10 06 1A 04 08 01 10 04 52 ...COMM........R"
     - "00000170 10 0A 06 44 45 50 54 4E 4F 10 07 1A 04 08 01 10 ...DEPTNO......."
     - "00000180 04 52 11 0A 07 53 4C 41 43 4B 45 52 10 08 1A 04 .R...SLACKER...."
     - "00000190 08 01 10 01 52 0D 0A 05 77 30 24 6F 30 10 09 1A ....R...w0$o0..."
     - "000001A0 02 10 05 0A BB 01 0A 28 74 79 70 65 2E 67 6F 6F ....»..(type.goo"
     - "000001B0 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E gleapis.com/plan"
     - "000001C0 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 .PLogicalProject"
     - "000001D0 12 8E 01 08 01 12 05 45 4D 50 4E 4F 12 05 45 4E .......EMPNO..EN"
     - "000001E0 41 4D 45 12 06 44 45 50 54 4E 4F 12 03 53 41 4C AME..DEPTNO..SAL"
     - "000001F0 12 0B 53 41 4C 41 52 59 5F 52 41 4E 4B 1A 08 12 ..SALARY_RANK..."
     - "00000200 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 ........6.4.0..."
     - "00000210 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "00000220 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "00000230 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A .2.ISO-8859-1..."
     - "00000240 0A 12 08 0A 04 08 01 10 04 10 07 1A 0A 12 08 0A ................"
     - "00000250 04 08 01 10 04 10 05 1A 08 12 06 0A 02 10 05 10 ................"
     - "00000260 09                                              ."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], DEPTNO=[$7], SAL=[$5], SALARY_RANK=[$9])"
     - "  LogicalWindow(window#0=[window(partition {7} order by [5 DESC] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [RANK()])])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "Calculate the Running Total of Salaries by Department"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    DEPTNO, \n    SAL, \n    SUM(SAL) OVER (PARTITION BY DEPTNO ORDER BY HIREDATE) AS RUNNING_TOTAL_SAL\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKugEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSjQESBUVNUE5PEgVFTkFNRRIISElSRURBVEUSA1NBTBIGREVQVE5PGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgwSCgoGCAEQDSADEAQaChIICgQIARAEEAUaChIICgQIARAEEAcKwAIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxKUAggBGmgKAQQaBBoCCAEiAhIAKgoKCAoGCAIQARgDMiVqIwoZCgIQBRIHCgVDT1VOVBoKEggKBAgBEAQQAxIGCgIYASADMiZqJAoYCgIQBRIGCgRTVU0wGgoSCAoECAEQBBADEgYKAhgBIAMYASKlARAoSAJSDQoFRU1QTk8aBAgBEARSOwoFRU5BTUUQARowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xUhQKCEhJUkVEQVRFEAIaBggBEA0gA1INCgNTQUwQAxoECAEQBFIQCgZERVBUTk8QBBoECAEQBFINCgV3MCRvMBAFGgIQBVINCgV3MCRvMRAGGgIQBQqQAgoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBLjAQgCEgVFTVBOTxIFRU5BTUUSBkRFUFROTxIDU0FMEhFSVU5OSU5HX1RPVEFMX1NBTBoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBBoKEggKBAgBEAQQAxpXKlUKBAgBEAUSBgoEQ0FTRRovKi0KAhABEg4KDEdSRUFURVJfVEhBThoIEgYKAhAFEAUaDSILCgIQBRIDEgEAUAYaCBIGCgIQBRAGGgoiCAoECAEQBVAg"
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A BA 01 0A 28 74 79 70 65 2E 67 ..EMP.º..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 8D 01 12 05 45 4D 50 4E 4F 12 05 45 4E ct.....EMPNO..EN"
     - "00000070 41 4D 45 12 08 48 49 52 45 44 41 54 45 12 03 53 AME..HIREDATE..S"
     - "00000080 41 4C 12 06 44 45 50 54 4E 4F 1A 08 12 06 0A 04 AL..DEPTNO......"
     - "00000090 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D 20 14 .....6.4.0.... ."
     - "000000A0 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 *...ISO-8859-1$e"
     - "000000B0 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A n_US$primary(.2."
     - "000000C0 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0C 12 0A ISO-8859-1......"
     - "000000D0 0A 06 08 01 10 0D 20 03 10 04 1A 0A 12 08 0A 04 ...... ........."
     - "000000E0 08 01 10 04 10 05 1A 0A 12 08 0A 04 08 01 10 04 ................"
     - "000000F0 10 07 0A C0 02 0A 27 74 79 70 65 2E 67 6F 6F 67 ...À..'type.goog"
     - "00000100 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E leapis.com/plan."
     - "00000110 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F 77 12 94 PLogicalWindow.."
     - "00000120 02 08 01 1A 68 0A 01 04 1A 04 1A 02 08 01 22 02 ....h.........\"."
     - "00000130 12 00 2A 0A 0A 08 0A 06 08 02 10 01 18 03 32 25 ..*...........2%"
     - "00000140 6A 23 0A 19 0A 02 10 05 12 07 0A 05 43 4F 55 4E j#..........COUN"
     - "00000150 54 1A 0A 12 08 0A 04 08 01 10 04 10 03 12 06 0A T..............."
     - "00000160 02 18 01 20 03 32 26 6A 24 0A 18 0A 02 10 05 12 ... .2&j$......."
     - "00000170 06 0A 04 53 55 4D 30 1A 0A 12 08 0A 04 08 01 10 ...SUM0........."
     - "00000180 04 10 03 12 06 0A 02 18 01 20 03 18 01 22 A5 01 ......... ...\"¥."
     - "00000190 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F 1A 04 08 .(H.R...EMPNO..."
     - "000001A0 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 01 1A 30 ...R;..ENAME...0"
     - "000001B0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "000001C0 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "000001D0 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "000001E0 52 14 0A 08 48 49 52 45 44 41 54 45 10 02 1A 06 R...HIREDATE...."
     - "000001F0 08 01 10 0D 20 03 52 0D 0A 03 53 41 4C 10 03 1A .... .R...SAL..."
     - "00000200 04 08 01 10 04 52 10 0A 06 44 45 50 54 4E 4F 10 .....R...DEPTNO."
     - "00000210 04 1A 04 08 01 10 04 52 0D 0A 05 77 30 24 6F 30 .......R...w0$o0"
     - "00000220 10 05 1A 02 10 05 52 0D 0A 05 77 30 24 6F 31 10 ......R...w0$o1."
     - "00000230 06 1A 02 10 05 0A 90 02 0A 28 74 79 70 65 2E 67 .........(type.g"
     - "00000240 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000250 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000260 63 74 12 E3 01 08 02 12 05 45 4D 50 4E 4F 12 05 ct.ã.....EMPNO.."
     - "00000270 45 4E 41 4D 45 12 06 44 45 50 54 4E 4F 12 03 53 ENAME..DEPTNO..S"
     - "00000280 41 4C 12 11 52 55 4E 4E 49 4E 47 5F 54 4F 54 41 AL..RUNNING_TOTA"
     - "00000290 4C 5F 53 41 4C 1A 08 12 06 0A 04 08 01 10 04 1A L_SAL..........."
     - "000002A0 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 6.4.0.... .*...I"
     - "000002B0 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 SO-8859-1$en_US$"
     - "000002C0 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 primary(.2.ISO-8"
     - "000002D0 38 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 859-1..........."
     - "000002E0 04 10 04 1A 0A 12 08 0A 04 08 01 10 04 10 03 1A ................"
     - "000002F0 57 2A 55 0A 04 08 01 10 05 12 06 0A 04 43 41 53 W*U..........CAS"
     - "00000300 45 1A 2F 2A 2D 0A 02 10 01 12 0E 0A 0C 47 52 45 E./*-........GRE"
     - "00000310 41 54 45 52 5F 54 48 41 4E 1A 08 12 06 0A 02 10 ATER_THAN......."
     - "00000320 05 10 05 1A 0D 22 0B 0A 02 10 05 12 03 12 01 00 .....\".........."
     - "00000330 50 06 1A 08 12 06 0A 02 10 05 10 06 1A 0A 22 08 P.............\"."
     - "00000340 0A 04 08 01 10 05 50 20                         ......P "
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], DEPTNO=[$4], SAL=[$3], RUNNING_TOTAL_SAL=[CASE(>($5, 0), $6, null:BIGINT)])"
     - "  LogicalWindow(window#0=[window(partition {4} order by [2] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [COUNT($3), $SUM0($3)])])"
     - "    LogicalProject(EMPNO=[$0], ENAME=[$1], HIREDATE=[$4], SAL=[$5], DEPTNO=[$7])"
     - "      LogicalTableScan(table=[[EMP]])"
 -
  description: "Find the Highest Salary in Each Department"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    DEPTNO, \n    SAL, \n    MAX(SAL) OVER (PARTITION BY DEPTNO) AS MAX_SALARY_IN_DEPT\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAK8AIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxLEAho6CgEHGgQaAggBIgQaAggCKgIKADIlaiMKGQoECAEQBBIFCgNNQVgaChIICgQIARAEEAUSBgoCGAMgAyKFAhAoSAJSDQoFRU1QTk8aBAgBEARSOwoFRU5BTUUQARowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xUjkKA0pPQhACGjAIARAdIAoqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSDQoDTUdSEAMaBAgBEARSFAoISElSRURBVEUQBBoGCAEQDSADUg0KA1NBTBAFGgQIARAEUg4KBENPTU0QBhoECAEQBFIQCgZERVBUTk8QBxoECAEQBFIRCgdTTEFDS0VSEAgaBAgBEAFSDwoFdzAkbzAQCRoECAEQBArEAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBKXAQgBEgVFTVBOTxIFRU5BTUUSBkRFUFROTxIDU0FMEhJNQVhfU0FMQVJZX0lOX0RFUFQaCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAcaChIICgQIARAEEAUaChIICgQIARAEEAk="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A F0 02 0A 27 74 79 70 65 2E 67 ..EMP.ð..'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F an.PLogicalWindo"
     - "00000060 77 12 C4 02 1A 3A 0A 01 07 1A 04 1A 02 08 01 22 w.Ä..:.........\""
     - "00000070 04 1A 02 08 02 2A 02 0A 00 32 25 6A 23 0A 19 0A .....*...2%j#..."
     - "00000080 04 08 01 10 04 12 05 0A 03 4D 41 58 1A 0A 12 08 .........MAX...."
     - "00000090 0A 04 08 01 10 04 10 05 12 06 0A 02 18 03 20 03 .............. ."
     - "000000A0 22 85 02 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F \"...(H.R...EMPNO"
     - "000000B0 1A 04 08 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 ......R;..ENAME."
     - "000000C0 01 1A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F ..0.... .*...ISO"
     - "000000D0 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 -8859-1$en_US$pr"
     - "000000E0 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 imary(.2.ISO-885"
     - "000000F0 39 2D 31 52 39 0A 03 4A 4F 42 10 02 1A 30 08 01 9-1R9..JOB...0.."
     - "00000100 10 1D 20 0A 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "00000110 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "00000120 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 52 0D (.2.ISO-8859-1R."
     - "00000130 0A 03 4D 47 52 10 03 1A 04 08 01 10 04 52 14 0A ..MGR........R.."
     - "00000140 08 48 49 52 45 44 41 54 45 10 04 1A 06 08 01 10 .HIREDATE......."
     - "00000150 0D 20 03 52 0D 0A 03 53 41 4C 10 05 1A 04 08 01 . .R...SAL......"
     - "00000160 10 04 52 0E 0A 04 43 4F 4D 4D 10 06 1A 04 08 01 ..R...COMM......"
     - "00000170 10 04 52 10 0A 06 44 45 50 54 4E 4F 10 07 1A 04 ..R...DEPTNO...."
     - "00000180 08 01 10 04 52 11 0A 07 53 4C 41 43 4B 45 52 10 ....R...SLACKER."
     - "00000190 08 1A 04 08 01 10 01 52 0F 0A 05 77 30 24 6F 30 .......R...w0$o0"
     - "000001A0 10 09 1A 04 08 01 10 04 0A C4 01 0A 28 74 79 70 .........Ä..(typ"
     - "000001B0 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D e.googleapis.com"
     - "000001C0 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 /plan.PLogicalPr"
     - "000001D0 6F 6A 65 63 74 12 97 01 08 01 12 05 45 4D 50 4E oject.......EMPN"
     - "000001E0 4F 12 05 45 4E 41 4D 45 12 06 44 45 50 54 4E 4F O..ENAME..DEPTNO"
     - "000001F0 12 03 53 41 4C 12 12 4D 41 58 5F 53 41 4C 41 52 ..SAL..MAX_SALAR"
     - "00000200 59 5F 49 4E 5F 44 45 50 54 1A 08 12 06 0A 04 08 Y_IN_DEPT......."
     - "00000210 01 10 04 1A 36 12 34 0A 30 08 01 10 1D 20 14 2A ....6.4.0.... .*"
     - "00000220 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E ...ISO-8859-1$en"
     - "00000230 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 _US$primary(.2.I"
     - "00000240 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 12 08 0A SO-8859-1......."
     - "00000250 04 08 01 10 04 10 07 1A 0A 12 08 0A 04 08 01 10 ................"
     - "00000260 04 10 05 1A 0A 12 08 0A 04 08 01 10 04 10 09    ..............."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], DEPTNO=[$7], SAL=[$5], MAX_SALARY_IN_DEPT=[$9])"
     - "  LogicalWindow(window#0=[window(partition {7} order by [] range between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING aggs [MAX($5)])])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "Calculate the Difference Between an Employee's Salary and the Average Salary of Their Department"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    DEPTNO, \n    SAL, \n    AVG(SAL) OVER (PARTITION BY DEPTNO) AS AVG_DEPT_SAL,\n    SAL - AVG(SAL) OVER (PARTITION BY DEPTNO) AS SALARY_DIFF_FROM_AVG\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKoQEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSdRIFRU1QTk8SBUVOQU1FEgNTQUwSBkRFUFROTxoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBRoKEggKBAgBEAQQBwqkAgondHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsV2luZG93EvgBCAEaYgoBAxoEGgIIASIEGgIIAioCCgAyJWojChkKAhAFEgcKBUNPVU5UGgoSCAoECAEQBBACEgYKAhgBIAMyJmokChgKAhAFEgYKBFNVTTAaChIICgQIARAEEAISBgoCGAEgAxgBIo8BEChIAlINCgVFTVBOTxoECAEQBFI7CgVFTkFNRRABGjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSDQoDU0FMEAIaBAgBEARSEAoGREVQVE5PEAMaBAgBEARSDQoFdzAkbzAQBBoCEAVSDQoFdzAkbzEQBRoCEAUKhwUKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QS2gQIAhIFRU1QTk8SBUVOQU1FEgZERVBUTk8SA1NBTBIMQVZHX0RFUFRfU0FMEhRTQUxBUllfRElGRl9GUk9NX0FWRxoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQAxoKEggKBAgBEAQQAhrMASrJAQoECAEQCRIICgZESVZJREUarAEqqQEKBAgBEAkSSBIEQ0FTVCIqb3JnLmFwYWNoZS5jYWxjaXRlLnNxbC5mdW4uU3FsQ2FzdEZ1bmN0aW9uKP///////////wEw////////////ARpXKlUKBAgBEAUSBgoEQ0FTRRovKi0KAhABEg4KDEdSRUFURVJfVEhBThoIEgYKAhAFEAQaDSILCgIQBRIDEgEAUAYaCBIGCgIQBRAFGgoiCAoECAEQBVAgGggSBgoCEAUQBBrtASrqAQoECAEQCRIHCgVNSU5VUxoKEggKBAgBEAQQAhrMASrJAQoECAEQCRIICgZESVZJREUarAEqqQEKBAgBEAkSSBIEQ0FTVCIqb3JnLmFwYWNoZS5jYWxjaXRlLnNxbC5mdW4uU3FsQ2FzdEZ1bmN0aW9uKP///////////wEw////////////ARpXKlUKBAgBEAUSBgoEQ0FTRRovKi0KAhABEg4KDEdSRUFURVJfVEhBThoIEgYKAhAFEAQaDSILCgIQBRIDEgEAUAYaCBIGCgIQBRAFGgoiCAoECAEQBVAgGggSBgoCEAUQBA=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A A1 01 0A 28 74 79 70 65 2E 67 ..EMP.¡..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 75 12 05 45 4D 50 4E 4F 12 05 45 4E 41 ct.u..EMPNO..ENA"
     - "00000070 4D 45 12 03 53 41 4C 12 06 44 45 50 54 4E 4F 1A ME..SAL..DEPTNO."
     - "00000080 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 ..........6.4.0."
     - "00000090 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 ... .*...ISO-885"
     - "000000A0 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 9-1$en_US$primar"
     - "000000B0 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 y(.2.ISO-8859-1."
     - "000000C0 01 1A 0A 12 08 0A 04 08 01 10 04 10 05 1A 0A 12 ................"
     - "000000D0 08 0A 04 08 01 10 04 10 07 0A A4 02 0A 27 74 79 ..........¤..'ty"
     - "000000E0 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F pe.googleapis.co"
     - "000000F0 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 m/plan.PLogicalW"
     - "00000100 69 6E 64 6F 77 12 F8 01 08 01 1A 62 0A 01 03 1A indow.ø....b...."
     - "00000110 04 1A 02 08 01 22 04 1A 02 08 02 2A 02 0A 00 32 .....\".....*...2"
     - "00000120 25 6A 23 0A 19 0A 02 10 05 12 07 0A 05 43 4F 55 %j#..........COU"
     - "00000130 4E 54 1A 0A 12 08 0A 04 08 01 10 04 10 02 12 06 NT.............."
     - "00000140 0A 02 18 01 20 03 32 26 6A 24 0A 18 0A 02 10 05 .... .2&j$......"
     - "00000150 12 06 0A 04 53 55 4D 30 1A 0A 12 08 0A 04 08 01 ....SUM0........"
     - "00000160 10 04 10 02 12 06 0A 02 18 01 20 03 18 01 22 8F .......... ...\"."
     - "00000170 01 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F 1A 04 ..(H.R...EMPNO.."
     - "00000180 08 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 01 1A ....R;..ENAME..."
     - "00000190 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 0.... .*...ISO-8"
     - "000001A0 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 859-1$en_US$prim"
     - "000001B0 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D ary(.2.ISO-8859-"
     - "000001C0 31 52 0D 0A 03 53 41 4C 10 02 1A 04 08 01 10 04 1R...SAL........"
     - "000001D0 52 10 0A 06 44 45 50 54 4E 4F 10 03 1A 04 08 01 R...DEPTNO......"
     - "000001E0 10 04 52 0D 0A 05 77 30 24 6F 30 10 04 1A 02 10 ..R...w0$o0....."
     - "000001F0 05 52 0D 0A 05 77 30 24 6F 31 10 05 1A 02 10 05 .R...w0$o1......"
     - "00000200 0A 87 05 0A 28 74 79 70 65 2E 67 6F 6F 67 6C 65 ....(type.google"
     - "00000210 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C apis.com/plan.PL"
     - "00000220 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 12 DA 04 ogicalProject.Ú."
     - "00000230 08 02 12 05 45 4D 50 4E 4F 12 05 45 4E 41 4D 45 ....EMPNO..ENAME"
     - "00000240 12 06 44 45 50 54 4E 4F 12 03 53 41 4C 12 0C 41 ..DEPTNO..SAL..A"
     - "00000250 56 47 5F 44 45 50 54 5F 53 41 4C 12 14 53 41 4C VG_DEPT_SAL..SAL"
     - "00000260 41 52 59 5F 44 49 46 46 5F 46 52 4F 4D 5F 41 56 ARY_DIFF_FROM_AV"
     - "00000270 47 1A 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A G...........6.4."
     - "00000280 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 0.... .*...ISO-8"
     - "00000290 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 859-1$en_US$prim"
     - "000002A0 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D ary(.2.ISO-8859-"
     - "000002B0 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 10 03 1A 1..............."
     - "000002C0 0A 12 08 0A 04 08 01 10 04 10 02 1A CC 01 2A C9 ............Ì.*É"
     - "000002D0 01 0A 04 08 01 10 09 12 08 0A 06 44 49 56 49 44 ...........DIVID"
     - "000002E0 45 1A AC 01 2A A9 01 0A 04 08 01 10 09 12 48 12 E.¬.*©........H."
     - "000002F0 04 43 41 53 54 22 2A 6F 72 67 2E 61 70 61 63 68 .CAST\"*org.apach"
     - "00000300 65 2E 63 61 6C 63 69 74 65 2E 73 71 6C 2E 66 75 e.calcite.sql.fu"
     - "00000310 6E 2E 53 71 6C 43 61 73 74 46 75 6E 63 74 69 6F n.SqlCastFunctio"
     - "00000320 6E 28 FF FF FF FF FF FF FF FF FF 01 30 FF FF FF n(..........0..."
     - "00000330 FF FF FF FF FF FF 01 1A 57 2A 55 0A 04 08 01 10 ........W*U....."
     - "00000340 05 12 06 0A 04 43 41 53 45 1A 2F 2A 2D 0A 02 10 .....CASE./*-..."
     - "00000350 01 12 0E 0A 0C 47 52 45 41 54 45 52 5F 54 48 41 .....GREATER_THA"
     - "00000360 4E 1A 08 12 06 0A 02 10 05 10 04 1A 0D 22 0B 0A N............\".."
     - "00000370 02 10 05 12 03 12 01 00 50 06 1A 08 12 06 0A 02 ........P......."
     - "00000380 10 05 10 05 1A 0A 22 08 0A 04 08 01 10 05 50 20 ......\".......P "
     - "00000390 1A 08 12 06 0A 02 10 05 10 04 1A ED 01 2A EA 01 ...........í.*ê."
     - "000003A0 0A 04 08 01 10 09 12 07 0A 05 4D 49 4E 55 53 1A ..........MINUS."
     - "000003B0 0A 12 08 0A 04 08 01 10 04 10 02 1A CC 01 2A C9 ............Ì.*É"
     - "000003C0 01 0A 04 08 01 10 09 12 08 0A 06 44 49 56 49 44 ...........DIVID"
     - "000003D0 45 1A AC 01 2A A9 01 0A 04 08 01 10 09 12 48 12 E.¬.*©........H."
     - "000003E0 04 43 41 53 54 22 2A 6F 72 67 2E 61 70 61 63 68 .CAST\"*org.apach"
     - "000003F0 65 2E 63 61 6C 63 69 74 65 2E 73 71 6C 2E 66 75 e.calcite.sql.fu"
     - "00000400 6E 2E 53 71 6C 43 61 73 74 46 75 6E 63 74 69 6F n.SqlCastFunctio"
     - "00000410 6E 28 FF FF FF FF FF FF FF FF FF 01 30 FF FF FF n(..........0..."
     - "00000420 FF FF FF FF FF FF 01 1A 57 2A 55 0A 04 08 01 10 ........W*U....."
     - "00000430 05 12 06 0A 04 43 41 53 45 1A 2F 2A 2D 0A 02 10 .....CASE./*-..."
     - "00000440 01 12 0E 0A 0C 47 52 45 41 54 45 52 5F 54 48 41 .....GREATER_THA"
     - "00000450 4E 1A 08 12 06 0A 02 10 05 10 04 1A 0D 22 0B 0A N............\".."
     - "00000460 02 10 05 12 03 12 01 00 50 06 1A 08 12 06 0A 02 ........P......."
     - "00000470 10 05 10 05 1A 0A 22 08 0A 04 08 01 10 05 50 20 ......\".......P "
     - "00000480 1A 08 12 06 0A 02 10 05 10 04                   .........."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], DEPTNO=[$3], SAL=[$2], AVG_DEPT_SAL=[/(CAST(CASE(>($4, 0), $5, null:BIGINT)):DOUBLE, $4)], SALARY_DIFF_FROM_AVG=[-($2, /(CAST(CASE(>($4, 0), $5, null:BIGINT)):DOUBLE, $4))])"
     - "  LogicalWindow(window#0=[window(partition {3} order by [] range between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING aggs [COUNT($2), $SUM0($2)])])"
     - "    LogicalProject(EMPNO=[$0], ENAME=[$1], SAL=[$5], DEPTNO=[$7])"
     - "      LogicalTableScan(table=[[EMP]])"
 -
  description: "Find the Previous and Next Employee's Salary"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    SAL, \n    LAG(SAL) OVER (ORDER BY HIREDATE) AS PREV_SALARY,\n    LEAD(SAL) OVER (ORDER BY HIREDATE) AS NEXT_SALARY\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKsgMKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxKGAxprGgQaAggBIgISACoKCggKBggEEAEYAzInaiUKGQoECAEQBBIFCgNMQUcaChIICgQIARAEEAUSCAoCGAEQASADMipqKAoaCgQIARAEEgYKBExFQUQaChIICgQIARAEEAUSCAoCGAEQASADGAEilgIQKEgCUg0KBUVNUE5PGgQIARAEUjsKBUVOQU1FEAEaMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMVI5CgNKT0IQAhowCAEQHSAKKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xUg0KA01HUhADGgQIARAEUhQKCEhJUkVEQVRFEAQaBggBEA0gA1INCgNTQUwQBRoECAEQBFIOCgRDT01NEAYaBAgBEARSEAoGREVQVE5PEAcaBAgBEARSEQoHU0xBQ0tFUhAIGgQIARABUg8KBXcwJG8wEAkaBAgBEARSDwoFdzAkbzEQChoECAEQBAqwAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBKDAQgBEgVFTVBOTxIFRU5BTUUSA1NBTBICJDMSAiQ0GggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBAFGgoSCAoECAEQBBAJGgoSCAoECAEQBBAK"
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A B2 03 0A 27 74 79 70 65 2E 67 ..EMP.²..'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F an.PLogicalWindo"
     - "00000060 77 12 86 03 1A 6B 1A 04 1A 02 08 01 22 02 12 00 w....k......\"..."
     - "00000070 2A 0A 0A 08 0A 06 08 04 10 01 18 03 32 27 6A 25 *...........2'j%"
     - "00000080 0A 19 0A 04 08 01 10 04 12 05 0A 03 4C 41 47 1A ............LAG."
     - "00000090 0A 12 08 0A 04 08 01 10 04 10 05 12 08 0A 02 18 ................"
     - "000000A0 01 10 01 20 03 32 2A 6A 28 0A 1A 0A 04 08 01 10 ... .2*j(......."
     - "000000B0 04 12 06 0A 04 4C 45 41 44 1A 0A 12 08 0A 04 08 .....LEAD......."
     - "000000C0 01 10 04 10 05 12 08 0A 02 18 01 10 01 20 03 18 ............. .."
     - "000000D0 01 22 96 02 10 28 48 02 52 0D 0A 05 45 4D 50 4E .\"...(H.R...EMPN"
     - "000000E0 4F 1A 04 08 01 10 04 52 3B 0A 05 45 4E 41 4D 45 O......R;..ENAME"
     - "000000F0 10 01 1A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 ...0.... .*...IS"
     - "00000100 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "00000110 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "00000120 35 39 2D 31 52 39 0A 03 4A 4F 42 10 02 1A 30 08 59-1R9..JOB...0."
     - "00000130 01 10 1D 20 0A 2A 1C 0A 18 49 53 4F 2D 38 38 35 ... .*...ISO-885"
     - "00000140 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 9-1$en_US$primar"
     - "00000150 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 52 y(.2.ISO-8859-1R"
     - "00000160 0D 0A 03 4D 47 52 10 03 1A 04 08 01 10 04 52 14 ...MGR........R."
     - "00000170 0A 08 48 49 52 45 44 41 54 45 10 04 1A 06 08 01 ..HIREDATE......"
     - "00000180 10 0D 20 03 52 0D 0A 03 53 41 4C 10 05 1A 04 08 .. .R...SAL....."
     - "00000190 01 10 04 52 0E 0A 04 43 4F 4D 4D 10 06 1A 04 08 ...R...COMM....."
     - "000001A0 01 10 04 52 10 0A 06 44 45 50 54 4E 4F 10 07 1A ...R...DEPTNO..."
     - "000001B0 04 08 01 10 04 52 11 0A 07 53 4C 41 43 4B 45 52 .....R...SLACKER"
     - "000001C0 10 08 1A 04 08 01 10 01 52 0F 0A 05 77 30 24 6F ........R...w0$o"
     - "000001D0 30 10 09 1A 04 08 01 10 04 52 0F 0A 05 77 30 24 0........R...w0$"
     - "000001E0 6F 31 10 0A 1A 04 08 01 10 04 0A B0 01 0A 28 74 o1.........°..(t"
     - "000001F0 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 ype.googleapis.c"
     - "00000200 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C om/plan.PLogical"
     - "00000210 50 72 6F 6A 65 63 74 12 83 01 08 01 12 05 45 4D Project.......EM"
     - "00000220 50 4E 4F 12 05 45 4E 41 4D 45 12 03 53 41 4C 12 PNO..ENAME..SAL."
     - "00000230 02 24 33 12 02 24 34 1A 08 12 06 0A 04 08 01 10 .$3..$4........."
     - "00000240 04 1A 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A ..6.4.0.... .*.."
     - "00000250 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 .ISO-8859-1$en_U"
     - "00000260 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F S$primary(.2.ISO"
     - "00000270 2D 38 38 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 -8859-1........."
     - "00000280 01 10 04 10 05 1A 0A 12 08 0A 04 08 01 10 04 10 ................"
     - "00000290 09 1A 0A 12 08 0A 04 08 01 10 04 10 0A          ............."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], SAL=[$5], $3=[$9], $4=[$10])"
     - "  LogicalWindow(window#0=[window(partition {} order by [4] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [LAG($5), LEAD($5)])])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "Calculate the Percent Rank of Each Employee's Salary Within the Company"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    SAL, \n    PERCENT_RANK() OVER (ORDER BY SAL DESC) AS SALARY_PERCENT_RANK\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAK8AIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxLEAho8GgQaAggBIgISACoKCggKBggFEAMYAjIkaiIKFAoCEAkSDgoMUEVSQ0VOVF9SQU5LEgoKAhgBEAEYASADIoMCEChIAlINCgVFTVBOTxoECAEQBFI7CgVFTkFNRRABGjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSOQoDSk9CEAIaMAgBEB0gCiocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMVINCgNNR1IQAxoECAEQBFIUCghISVJFREFURRAEGgYIARANIANSDQoDU0FMEAUaBAgBEARSDgoEQ09NTRAGGgQIARAEUhAKBkRFUFROTxAHGgQIARAEUhEKB1NMQUNLRVIQCBoECAEQAVINCgV3MCRvMBAJGgIQCQqdAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJxCAESBUVNUE5PEgVFTkFNRRIDU0FMEgIkMxoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBRoIEgYKAhAJEAk="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A F0 02 0A 27 74 79 70 65 2E 67 ..EMP.ð..'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F an.PLogicalWindo"
     - "00000060 77 12 C4 02 1A 3C 1A 04 1A 02 08 01 22 02 12 00 w.Ä..<......\"..."
     - "00000070 2A 0A 0A 08 0A 06 08 05 10 03 18 02 32 24 6A 22 *...........2$j\""
     - "00000080 0A 14 0A 02 10 09 12 0E 0A 0C 50 45 52 43 45 4E ..........PERCEN"
     - "00000090 54 5F 52 41 4E 4B 12 0A 0A 02 18 01 10 01 18 01 T_RANK.........."
     - "000000A0 20 03 22 83 02 10 28 48 02 52 0D 0A 05 45 4D 50  .\"...(H.R...EMP"
     - "000000B0 4E 4F 1A 04 08 01 10 04 52 3B 0A 05 45 4E 41 4D NO......R;..ENAM"
     - "000000C0 45 10 01 1A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 E...0.... .*...I"
     - "000000D0 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 SO-8859-1$en_US$"
     - "000000E0 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 primary(.2.ISO-8"
     - "000000F0 38 35 39 2D 31 52 39 0A 03 4A 4F 42 10 02 1A 30 859-1R9..JOB...0"
     - "00000100 08 01 10 1D 20 0A 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "00000110 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "00000120 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "00000130 52 0D 0A 03 4D 47 52 10 03 1A 04 08 01 10 04 52 R...MGR........R"
     - "00000140 14 0A 08 48 49 52 45 44 41 54 45 10 04 1A 06 08 ...HIREDATE....."
     - "00000150 01 10 0D 20 03 52 0D 0A 03 53 41 4C 10 05 1A 04 ... .R...SAL...."
     - "00000160 08 01 10 04 52 0E 0A 04 43 4F 4D 4D 10 06 1A 04 ....R...COMM...."
     - "00000170 08 01 10 04 52 10 0A 06 44 45 50 54 4E 4F 10 07 ....R...DEPTNO.."
     - "00000180 1A 04 08 01 10 04 52 11 0A 07 53 4C 41 43 4B 45 ......R...SLACKE"
     - "00000190 52 10 08 1A 04 08 01 10 01 52 0D 0A 05 77 30 24 R........R...w0$"
     - "000001A0 6F 30 10 09 1A 02 10 09 0A 9D 01 0A 28 74 79 70 o0..........(typ"
     - "000001B0 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D e.googleapis.com"
     - "000001C0 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 /plan.PLogicalPr"
     - "000001D0 6F 6A 65 63 74 12 71 08 01 12 05 45 4D 50 4E 4F oject.q....EMPNO"
     - "000001E0 12 05 45 4E 41 4D 45 12 03 53 41 4C 12 02 24 33 ..ENAME..SAL..$3"
     - "000001F0 1A 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 ...........6.4.0"
     - "00000200 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "00000210 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "00000220 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "00000230 10 01 1A 0A 12 08 0A 04 08 01 10 04 10 05 1A 08 ................"
     - "00000240 12 06 0A 02 10 09 10 09                         ........"
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], SAL=[$5], $3=[$9])"
     - "  LogicalWindow(window#0=[window(partition {} order by [5 DESC] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [PERCENT_RANK()])])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "Cumulative Distribution of Employees' Salaries"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    SAL, \n    CUME_DIST() OVER (ORDER BY SAL DESC) AS SALARY_CUME_DIST\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAK7QIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxLBAho5GgQaAggBIgISACoKCggKBggFEAMYAjIhah8KEQoCEAkSCwoJQ1VNRV9ESVNUEgoKAhgBEAEYASADIoMCEChIAlINCgVFTVBOTxoECAEQBFI7CgVFTkFNRRABGjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTFSOQoDSk9CEAIaMAgBEB0gCiocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMVINCgNNR1IQAxoECAEQBFIUCghISVJFREFURRAEGgYIARANIANSDQoDU0FMEAUaBAgBEARSDgoEQ09NTRAGGgQIARAEUhAKBkRFUFROTxAHGgQIARAEUhEKB1NMQUNLRVIQCBoECAEQAVINCgV3MCRvMBAJGgIQCQqdAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJxCAESBUVNUE5PEgVFTkFNRRIDU0FMEgIkMxoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBRoIEgYKAhAJEAk="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A ED 02 0A 27 74 79 70 65 2E 67 ..EMP.í..'type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F an.PLogicalWindo"
     - "00000060 77 12 C1 02 1A 39 1A 04 1A 02 08 01 22 02 12 00 w.Á..9......\"..."
     - "00000070 2A 0A 0A 08 0A 06 08 05 10 03 18 02 32 21 6A 1F *...........2!j."
     - "00000080 0A 11 0A 02 10 09 12 0B 0A 09 43 55 4D 45 5F 44 ..........CUME_D"
     - "00000090 49 53 54 12 0A 0A 02 18 01 10 01 18 01 20 03 22 IST.......... .\""
     - "000000A0 83 02 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F 1A ...(H.R...EMPNO."
     - "000000B0 04 08 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 01 .....R;..ENAME.."
     - "000000C0 1A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D .0.... .*...ISO-"
     - "000000D0 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 8859-1$en_US$pri"
     - "000000E0 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 mary(.2.ISO-8859"
     - "000000F0 2D 31 52 39 0A 03 4A 4F 42 10 02 1A 30 08 01 10 -1R9..JOB...0..."
     - "00000100 1D 20 0A 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "00000110 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "00000120 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 52 0D 0A .2.ISO-8859-1R.."
     - "00000130 03 4D 47 52 10 03 1A 04 08 01 10 04 52 14 0A 08 .MGR........R..."
     - "00000140 48 49 52 45 44 41 54 45 10 04 1A 06 08 01 10 0D HIREDATE........"
     - "00000150 20 03 52 0D 0A 03 53 41 4C 10 05 1A 04 08 01 10  .R...SAL......."
     - "00000160 04 52 0E 0A 04 43 4F 4D 4D 10 06 1A 04 08 01 10 .R...COMM......."
     - "00000170 04 52 10 0A 06 44 45 50 54 4E 4F 10 07 1A 04 08 .R...DEPTNO....."
     - "00000180 01 10 04 52 11 0A 07 53 4C 41 43 4B 45 52 10 08 ...R...SLACKER.."
     - "00000190 1A 04 08 01 10 01 52 0D 0A 05 77 30 24 6F 30 10 ......R...w0$o0."
     - "000001A0 09 1A 02 10 09 0A 9D 01 0A 28 74 79 70 65 2E 67 .........(type.g"
     - "000001B0 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "000001C0 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "000001D0 63 74 12 71 08 01 12 05 45 4D 50 4E 4F 12 05 45 ct.q....EMPNO..E"
     - "000001E0 4E 41 4D 45 12 03 53 41 4C 12 02 24 33 1A 08 12 NAME..SAL..$3..."
     - "000001F0 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 ........6.4.0..."
     - "00000200 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "00000210 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "00000220 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A .2.ISO-8859-1..."
     - "00000230 0A 12 08 0A 04 08 01 10 04 10 05 1A 08 12 06 0A ................"
     - "00000240 02 10 09 10 09                                  ....."
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], SAL=[$5], $3=[$9])"
     - "  LogicalWindow(window#0=[window(partition {} order by [5 DESC] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [CUME_DIST()])])"
     - "    LogicalTableScan(table=[[EMP]])"
 -
  description: "Moving Average of Salaries Over the Last 3 Employees by Hire Date"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    SAL, \n    AVG(SAL) OVER (ORDER BY HIREDATE ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS MOVING_AVG_SAL\nFROM \n    EMP\n"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKpQEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSeRIFRU1QTk8SBUVOQU1FEghISVJFREFURRIDU0FMGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgwSCgoGCAEQDSADEAQaChIICgQIARAEEAUKxgIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxKaAggBEg0iCwoCEAQSAxIBAlAGGnEQARoOCgwKCBIGCgIQBBAEEAEiAhIAKgoKCAoGCAIQARgDMiVqIwoZCgIQBRIHCgVDT1VOVBoKEggKBAgBEAQQAxIGCgIYASADMiZqJAoYCgIQBRIGCgRTVU0wGgoSCAoECAEQBBADEgYKAhgBIAMYASKTARAoSAJSDQoFRU1QTk8aBAgBEARSOwoFRU5BTUUQARowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xUhQKCEhJUkVEQVRFEAIaBggBEA0gA1INCgNTQUwQAxoECAEQBFINCgV3MCRvMBAEGgIQBVINCgV3MCRvMRAFGgIQBQrvAgoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBLCAggCEgVFTVBOTxIFRU5BTUUSA1NBTBIOTU9WSU5HX0FWR19TQUwaCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAMazAEqyQEKBAgBEAkSCAoGRElWSURFGqwBKqkBCgQIARAJEkgSBENBU1QiKm9yZy5hcGFjaGUuY2FsY2l0ZS5zcWwuZnVuLlNxbENhc3RGdW5jdGlvbij///////////8BMP///////////wEaVypVCgQIARAFEgYKBENBU0UaLyotCgIQARIOCgxHUkVBVEVSX1RIQU4aCBIGCgIQBRAEGg0iCwoCEAUSAxIBAFAGGggSBgoCEAUQBRoKIggKBAgBEAVQIBoIEgYKAhAFEAQ="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A A5 01 0A 28 74 79 70 65 2E 67 ..EMP.¥..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 79 12 05 45 4D 50 4E 4F 12 05 45 4E 41 ct.y..EMPNO..ENA"
     - "00000070 4D 45 12 08 48 49 52 45 44 41 54 45 12 03 53 41 ME..HIREDATE..SA"
     - "00000080 4C 1A 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A L...........6.4."
     - "00000090 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 0.... .*...ISO-8"
     - "000000A0 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 859-1$en_US$prim"
     - "000000B0 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D ary(.2.ISO-8859-"
     - "000000C0 31 10 01 1A 0C 12 0A 0A 06 08 01 10 0D 20 03 10 1............ .."
     - "000000D0 04 1A 0A 12 08 0A 04 08 01 10 04 10 05 0A C6 02 ..............Æ."
     - "000000E0 0A 27 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 .'type.googleapi"
     - "000000F0 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 s.com/plan.PLogi"
     - "00000100 63 61 6C 57 69 6E 64 6F 77 12 9A 02 08 01 12 0D calWindow......."
     - "00000110 22 0B 0A 02 10 04 12 03 12 01 02 50 06 1A 71 10 \"..........P..q."
     - "00000120 01 1A 0E 0A 0C 0A 08 12 06 0A 02 10 04 10 04 10 ................"
     - "00000130 01 22 02 12 00 2A 0A 0A 08 0A 06 08 02 10 01 18 .\"...*.........."
     - "00000140 03 32 25 6A 23 0A 19 0A 02 10 05 12 07 0A 05 43 .2%j#..........C"
     - "00000150 4F 55 4E 54 1A 0A 12 08 0A 04 08 01 10 04 10 03 OUNT............"
     - "00000160 12 06 0A 02 18 01 20 03 32 26 6A 24 0A 18 0A 02 ...... .2&j$...."
     - "00000170 10 05 12 06 0A 04 53 55 4D 30 1A 0A 12 08 0A 04 ......SUM0......"
     - "00000180 08 01 10 04 10 03 12 06 0A 02 18 01 20 03 18 01 ............ ..."
     - "00000190 22 93 01 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F \"...(H.R...EMPNO"
     - "000001A0 1A 04 08 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 ......R;..ENAME."
     - "000001B0 01 1A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F ..0.... .*...ISO"
     - "000001C0 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 -8859-1$en_US$pr"
     - "000001D0 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 imary(.2.ISO-885"
     - "000001E0 39 2D 31 52 14 0A 08 48 49 52 45 44 41 54 45 10 9-1R...HIREDATE."
     - "000001F0 02 1A 06 08 01 10 0D 20 03 52 0D 0A 03 53 41 4C ....... .R...SAL"
     - "00000200 10 03 1A 04 08 01 10 04 52 0D 0A 05 77 30 24 6F ........R...w0$o"
     - "00000210 30 10 04 1A 02 10 05 52 0D 0A 05 77 30 24 6F 31 0......R...w0$o1"
     - "00000220 10 05 1A 02 10 05 0A EF 02 0A 28 74 79 70 65 2E .......ï..(type."
     - "00000230 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 googleapis.com/p"
     - "00000240 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A lan.PLogicalProj"
     - "00000250 65 63 74 12 C2 02 08 02 12 05 45 4D 50 4E 4F 12 ect.Â.....EMPNO."
     - "00000260 05 45 4E 41 4D 45 12 03 53 41 4C 12 0E 4D 4F 56 .ENAME..SAL..MOV"
     - "00000270 49 4E 47 5F 41 56 47 5F 53 41 4C 1A 08 12 06 0A ING_AVG_SAL....."
     - "00000280 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D 20 ......6.4.0.... "
     - "00000290 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 .*...ISO-8859-1$"
     - "000002A0 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 en_US$primary(.2"
     - "000002B0 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 12 .ISO-8859-1....."
     - "000002C0 08 0A 04 08 01 10 04 10 03 1A CC 01 2A C9 01 0A ..........Ì.*É.."
     - "000002D0 04 08 01 10 09 12 08 0A 06 44 49 56 49 44 45 1A .........DIVIDE."
     - "000002E0 AC 01 2A A9 01 0A 04 08 01 10 09 12 48 12 04 43 ¬.*©........H..C"
     - "000002F0 41 53 54 22 2A 6F 72 67 2E 61 70 61 63 68 65 2E AST\"*org.apache."
     - "00000300 63 61 6C 63 69 74 65 2E 73 71 6C 2E 66 75 6E 2E calcite.sql.fun."
     - "00000310 53 71 6C 43 61 73 74 46 75 6E 63 74 69 6F 6E 28 SqlCastFunction("
     - "00000320 FF FF FF FF FF FF FF FF FF 01 30 FF FF FF FF FF ..........0....."
     - "00000330 FF FF FF FF 01 1A 57 2A 55 0A 04 08 01 10 05 12 ......W*U......."
     - "00000340 06 0A 04 43 41 53 45 1A 2F 2A 2D 0A 02 10 01 12 ...CASE./*-....."
     - "00000350 0E 0A 0C 47 52 45 41 54 45 52 5F 54 48 41 4E 1A ...GREATER_THAN."
     - "00000360 08 12 06 0A 02 10 05 10 04 1A 0D 22 0B 0A 02 10 ...........\"...."
     - "00000370 05 12 03 12 01 00 50 06 1A 08 12 06 0A 02 10 05 ......P........."
     - "00000380 10 05 1A 0A 22 08 0A 04 08 01 10 05 50 20 1A 08 ....\".......P .."
     - "00000390 12 06 0A 02 10 05 10 04                         ........"
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], SAL=[$3], MOVING_AVG_SAL=[/(CAST(CASE(>($4, 0), $5, null:BIGINT)):DOUBLE, $4)])"
     - "  LogicalWindow(window#0=[window(partition {} order by [2] rows between $4 PRECEDING and CURRENT ROW aggs [COUNT($3), $SUM0($3)])])"
     - "    LogicalProject(EMPNO=[$0], ENAME=[$1], HIREDATE=[$4], SAL=[$5])"
     - "      LogicalTableScan(table=[[EMP]])"
 -
  description: "Cumulative Salary by Department Ordered by Hire Date"
  input: "SELECT \n    EMPNO, \n    ENAME, \n    DEPTNO, \n    SAL, \n    HIREDATE,\n    SUM(SAL) OVER (PARTITION BY DEPTNO ORDER BY HIREDATE ASC) AS CUMULATIVE_SALARY\nFROM \n    EMP"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKugEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSjQESBUVNUE5PEgVFTkFNRRIISElSRURBVEUSA1NBTBIGREVQVE5PGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgwSCgoGCAEQDSADEAQaChIICgQIARAEEAUaChIICgQIARAEEAcKwAIKJ3R5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFdpbmRvdxKUAggBGmgKAQQaBBoCCAEiAhIAKgoKCAoGCAIQARgDMiVqIwoZCgIQBRIHCgVDT1VOVBoKEggKBAgBEAQQAxIGCgIYASADMiZqJAoYCgIQBRIGCgRTVU0wGgoSCAoECAEQBBADEgYKAhgBIAMYASKlARAoSAJSDQoFRU1QTk8aBAgBEARSOwoFRU5BTUUQARowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xUhQKCEhJUkVEQVRFEAIaBggBEA0gA1INCgNTQUwQAxoECAEQBFIQCgZERVBUTk8QBBoECAEQBFINCgV3MCRvMBAFGgIQBVINCgV3MCRvMRAGGgIQBQqoAgoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBL7AQgCEgVFTVBOTxIFRU5BTUUSBkRFUFROTxIDU0FMEghISVJFREFURRIRQ1VNVUxBVElWRV9TQUxBUlkaCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAQaChIICgQIARAEEAMaDBIKCgYIARANIAMQAhpXKlUKBAgBEAUSBgoEQ0FTRRovKi0KAhABEg4KDEdSRUFURVJfVEhBThoIEgYKAhAFEAUaDSILCgIQBRIDEgEAUAYaCBIGCgIQBRAGGgoiCAoECAEQBVAg"
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A BA 01 0A 28 74 79 70 65 2E 67 ..EMP.º..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 8D 01 12 05 45 4D 50 4E 4F 12 05 45 4E ct.....EMPNO..EN"
     - "00000070 41 4D 45 12 08 48 49 52 45 44 41 54 45 12 03 53 AME..HIREDATE..S"
     - "00000080 41 4C 12 06 44 45 50 54 4E 4F 1A 08 12 06 0A 04 AL..DEPTNO......"
     - "00000090 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D 20 14 .....6.4.0.... ."
     - "000000A0 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 *...ISO-8859-1$e"
     - "000000B0 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A n_US$primary(.2."
     - "000000C0 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0C 12 0A ISO-8859-1......"
     - "000000D0 0A 06 08 01 10 0D 20 03 10 04 1A 0A 12 08 0A 04 ...... ........."
     - "000000E0 08 01 10 04 10 05 1A 0A 12 08 0A 04 08 01 10 04 ................"
     - "000000F0 10 07 0A C0 02 0A 27 74 79 70 65 2E 67 6F 6F 67 ...À..'type.goog"
     - "00000100 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E leapis.com/plan."
     - "00000110 50 4C 6F 67 69 63 61 6C 57 69 6E 64 6F 77 12 94 PLogicalWindow.."
     - "00000120 02 08 01 1A 68 0A 01 04 1A 04 1A 02 08 01 22 02 ....h.........\"."
     - "00000130 12 00 2A 0A 0A 08 0A 06 08 02 10 01 18 03 32 25 ..*...........2%"
     - "00000140 6A 23 0A 19 0A 02 10 05 12 07 0A 05 43 4F 55 4E j#..........COUN"
     - "00000150 54 1A 0A 12 08 0A 04 08 01 10 04 10 03 12 06 0A T..............."
     - "00000160 02 18 01 20 03 32 26 6A 24 0A 18 0A 02 10 05 12 ... .2&j$......."
     - "00000170 06 0A 04 53 55 4D 30 1A 0A 12 08 0A 04 08 01 10 ...SUM0........."
     - "00000180 04 10 03 12 06 0A 02 18 01 20 03 18 01 22 A5 01 ......... ...\"¥."
     - "00000190 10 28 48 02 52 0D 0A 05 45 4D 50 4E 4F 1A 04 08 .(H.R...EMPNO..."
     - "000001A0 01 10 04 52 3B 0A 05 45 4E 41 4D 45 10 01 1A 30 ...R;..ENAME...0"
     - "000001B0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "000001C0 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "000001D0 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "000001E0 52 14 0A 08 48 49 52 45 44 41 54 45 10 02 1A 06 R...HIREDATE...."
     - "000001F0 08 01 10 0D 20 03 52 0D 0A 03 53 41 4C 10 03 1A .... .R...SAL..."
     - "00000200 04 08 01 10 04 52 10 0A 06 44 45 50 54 4E 4F 10 .....R...DEPTNO."
     - "00000210 04 1A 04 08 01 10 04 52 0D 0A 05 77 30 24 6F 30 .......R...w0$o0"
     - "00000220 10 05 1A 02 10 05 52 0D 0A 05 77 30 24 6F 31 10 ......R...w0$o1."
     - "00000230 06 1A 02 10 05 0A A8 02 0A 28 74 79 70 65 2E 67 ......¨..(type.g"
     - "00000240 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000250 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000260 63 74 12 FB 01 08 02 12 05 45 4D 50 4E 4F 12 05 ct.û.....EMPNO.."
     - "00000270 45 4E 41 4D 45 12 06 44 45 50 54 4E 4F 12 03 53 ENAME..DEPTNO..S"
     - "00000280 41 4C 12 08 48 49 52 45 44 41 54 45 12 11 43 55 AL..HIREDATE..CU"
     - "00000290 4D 55 4C 41 54 49 56 45 5F 53 41 4C 41 52 59 1A MULATIVE_SALARY."
     - "000002A0 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 ..........6.4.0."
     - "000002B0 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 ... .*...ISO-885"
     - "000002C0 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 9-1$en_US$primar"
     - "000002D0 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 y(.2.ISO-8859-1."
     - "000002E0 01 1A 0A 12 08 0A 04 08 01 10 04 10 04 1A 0A 12 ................"
     - "000002F0 08 0A 04 08 01 10 04 10 03 1A 0C 12 0A 0A 06 08 ................"
     - "00000300 01 10 0D 20 03 10 02 1A 57 2A 55 0A 04 08 01 10 ... ....W*U....."
     - "00000310 05 12 06 0A 04 43 41 53 45 1A 2F 2A 2D 0A 02 10 .....CASE./*-..."
     - "00000320 01 12 0E 0A 0C 47 52 45 41 54 45 52 5F 54 48 41 .....GREATER_THA"
     - "00000330 4E 1A 08 12 06 0A 02 10 05 10 05 1A 0D 22 0B 0A N............\".."
     - "00000340 02 10 05 12 03 12 01 00 50 06 1A 08 12 06 0A 02 ........P......."
     - "00000350 10 05 10 06 1A 0A 22 08 0A 04 08 01 10 05 50 20 ......\".......P "
    queryPlanText:
     - "LogicalProject(EMPNO=[$0], ENAME=[$1], DEPTNO=[$4], SAL=[$3], HIREDATE=[$2], CUMULATIVE_SALARY=[CASE(>($5, 0), $6, null:BIGINT)])"
     - "  LogicalWindow(window#0=[window(partition {4} order by [2] range between UNBOUNDED PRECEDING and CURRENT ROW aggs [COUNT($3), $SUM0($3)])])"
     - "    LogicalProject(EMPNO=[$0], ENAME=[$1], HIREDATE=[$4], SAL=[$5], DEPTNO=[$7])"
     - "      LogicalTableScan(table=[[EMP]])"

