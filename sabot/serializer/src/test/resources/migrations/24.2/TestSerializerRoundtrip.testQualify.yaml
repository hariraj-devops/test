#
# Copyright (C) 2017-2019 Dremio Corporation
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

---
 -
  description: "QUALIFY WITHOUT REFERENCES"
  input: "SELECT empno, ename, deptno FROM emp QUALIFY ROW_NUMBER() over (partition by ename order by deptno) = 1"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKsQIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QShAISBWVtcG5vEgVlbmFtZRIGZGVwdG5vEhFRdWFsaWZ5RXhwcmVzc2lvbhoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBxqKASqHAQoCEAESCAoGRVFVQUxTGmgyZgoCEAUSDAoKUk9XX05VTUJFUiJSCjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAESDAoKEggKBAgBEAQQBxoEGgIIASICEgAoARoNIgsKAhAFEgMSAQFQBgo3Cid0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxGaWx0ZXISDBABGggSBgoCEAEQAwqSAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJmCAISBWVtcG5vEgVlbmFtZRIGZGVwdG5vGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBAC"
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A B1 02 0A 28 74 79 70 65 2E 67 ..EMP.±..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 84 02 12 05 65 6D 70 6E 6F 12 05 65 6E ct.....empno..en"
     - "00000070 61 6D 65 12 06 64 65 70 74 6E 6F 12 11 51 75 61 ame..deptno..Qua"
     - "00000080 6C 69 66 79 45 78 70 72 65 73 73 69 6F 6E 1A 08 lifyExpression.."
     - "00000090 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 .........6.4.0.."
     - "000000A0 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "000000B0 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "000000C0 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 (.2.ISO-8859-1.."
     - "000000D0 1A 0A 12 08 0A 04 08 01 10 04 10 07 1A 8A 01 2A ...............*"
     - "000000E0 87 01 0A 02 10 01 12 08 0A 06 45 51 55 41 4C 53 ..........EQUALS"
     - "000000F0 1A 68 32 66 0A 02 10 05 12 0C 0A 0A 52 4F 57 5F .h2f........ROW_"
     - "00000100 4E 55 4D 42 45 52 22 52 0A 36 12 34 0A 30 08 01 NUMBER\"R.6.4.0.."
     - "00000110 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "00000120 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "00000130 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 (.2.ISO-8859-1.."
     - "00000140 12 0C 0A 0A 12 08 0A 04 08 01 10 04 10 07 1A 04 ................"
     - "00000150 1A 02 08 01 22 02 12 00 28 01 1A 0D 22 0B 0A 02 ....\"...(...\"..."
     - "00000160 10 05 12 03 12 01 01 50 06 0A 37 0A 27 74 79 70 .......P..7.'typ"
     - "00000170 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D e.googleapis.com"
     - "00000180 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 46 69 /plan.PLogicalFi"
     - "00000190 6C 74 65 72 12 0C 10 01 1A 08 12 06 0A 02 10 01 lter............"
     - "000001A0 10 03 0A 92 01 0A 28 74 79 70 65 2E 67 6F 6F 67 ......(type.goog"
     - "000001B0 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E leapis.com/plan."
     - "000001C0 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 12 PLogicalProject."
     - "000001D0 66 08 02 12 05 65 6D 70 6E 6F 12 05 65 6E 61 6D f....empno..enam"
     - "000001E0 65 12 06 64 65 70 74 6E 6F 1A 08 12 06 0A 04 08 e..deptno......."
     - "000001F0 01 10 04 1A 36 12 34 0A 30 08 01 10 1D 20 14 2A ....6.4.0.... .*"
     - "00000200 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E ...ISO-8859-1$en"
     - "00000210 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 _US$primary(.2.I"
     - "00000220 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 12 08 0A SO-8859-1......."
     - "00000230 04 08 01 10 04 10 02                            ......."
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2])"
     - "  LogicalFilter(condition=[$3])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$7], QualifyExpression=[=(ROW_NUMBER() OVER (PARTITION BY $1 ORDER BY $7 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 1)])"
     - "      LogicalTableScan(table=[[EMP]])"
 -
  description: "QUALIFY WITHOUT REFERENCES AND FILTER"
  input: "SELECT empno, ename, deptno FROM emp WHERE deptno > 5 QUALIFY ROW_NUMBER() over (partition by ename order by deptno) = 1"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKYAondHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsRmlsdGVyEjUaMyoxCgQIARABEg4KDEdSRUFURVJfVEhBThoKEggKBAgBEAQQBxoNIgsKAhAEEgMSAQVQBgqzAgoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBKGAggBEgVlbXBubxIFZW5hbWUSBmRlcHRubxIRUXVhbGlmeUV4cHJlc3Npb24aCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAcaigEqhwEKAhABEggKBkVRVUFMUxpoMmYKAhAFEgwKClJPV19OVU1CRVIiUgo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABEgwKChIICgQIARAEEAcaBBoCCAEiAhIAKAEaDSILCgIQBRIDEgEBUAYKNwondHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsRmlsdGVyEgwQAhoIEgYKAhABEAMKkgEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSZggDEgVlbXBubxIFZW5hbWUSBmRlcHRubxoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQAg=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A 60 0A 27 74 79 70 65 2E 67 6F ..EMP.`.'type.go"
     - "00000040 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 ogleapis.com/pla"
     - "00000050 6E 2E 50 4C 6F 67 69 63 61 6C 46 69 6C 74 65 72 n.PLogicalFilter"
     - "00000060 12 35 1A 33 2A 31 0A 04 08 01 10 01 12 0E 0A 0C .5.3*1.........."
     - "00000070 47 52 45 41 54 45 52 5F 54 48 41 4E 1A 0A 12 08 GREATER_THAN...."
     - "00000080 0A 04 08 01 10 04 10 07 1A 0D 22 0B 0A 02 10 04 ..........\"....."
     - "00000090 12 03 12 01 05 50 06 0A B3 02 0A 28 74 79 70 65 .....P..³..(type"
     - "000000A0 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F .googleapis.com/"
     - "000000B0 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F plan.PLogicalPro"
     - "000000C0 6A 65 63 74 12 86 02 08 01 12 05 65 6D 70 6E 6F ject.......empno"
     - "000000D0 12 05 65 6E 61 6D 65 12 06 64 65 70 74 6E 6F 12 ..ename..deptno."
     - "000000E0 11 51 75 61 6C 69 66 79 45 78 70 72 65 73 73 69 .QualifyExpressi"
     - "000000F0 6F 6E 1A 08 12 06 0A 04 08 01 10 04 1A 36 12 34 on...........6.4"
     - "00000100 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D .0.... .*...ISO-"
     - "00000110 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 8859-1$en_US$pri"
     - "00000120 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 mary(.2.ISO-8859"
     - "00000130 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 10 07 -1.............."
     - "00000140 1A 8A 01 2A 87 01 0A 02 10 01 12 08 0A 06 45 51 ...*..........EQ"
     - "00000150 55 41 4C 53 1A 68 32 66 0A 02 10 05 12 0C 0A 0A UALS.h2f........"
     - "00000160 52 4F 57 5F 4E 55 4D 42 45 52 22 52 0A 36 12 34 ROW_NUMBER\"R.6.4"
     - "00000170 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D .0.... .*...ISO-"
     - "00000180 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 8859-1$en_US$pri"
     - "00000190 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 mary(.2.ISO-8859"
     - "000001A0 2D 31 10 01 12 0C 0A 0A 12 08 0A 04 08 01 10 04 -1.............."
     - "000001B0 10 07 1A 04 1A 02 08 01 22 02 12 00 28 01 1A 0D ........\"...(..."
     - "000001C0 22 0B 0A 02 10 05 12 03 12 01 01 50 06 0A 37 0A \"..........P..7."
     - "000001D0 27 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 'type.googleapis"
     - "000001E0 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 .com/plan.PLogic"
     - "000001F0 61 6C 46 69 6C 74 65 72 12 0C 10 02 1A 08 12 06 alFilter........"
     - "00000200 0A 02 10 01 10 03 0A 92 01 0A 28 74 79 70 65 2E ..........(type."
     - "00000210 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 googleapis.com/p"
     - "00000220 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A lan.PLogicalProj"
     - "00000230 65 63 74 12 66 08 03 12 05 65 6D 70 6E 6F 12 05 ect.f....empno.."
     - "00000240 65 6E 61 6D 65 12 06 64 65 70 74 6E 6F 1A 08 12 ename..deptno..."
     - "00000250 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 ........6.4.0..."
     - "00000260 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D . .*...ISO-8859-"
     - "00000270 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 1$en_US$primary("
     - "00000280 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A .2.ISO-8859-1..."
     - "00000290 0A 12 08 0A 04 08 01 10 04 10 02                ..........."
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2])"
     - "  LogicalFilter(condition=[$3])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$7], QualifyExpression=[=(ROW_NUMBER() OVER (PARTITION BY $1 ORDER BY $7 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 1)])"
     - "      LogicalFilter(condition=[>($7, 5)])"
     - "        LogicalTableScan(table=[[EMP]])"
 -
  description: "QUALIFY WITH REFERENCES"
  input: "SELECT empno, ename, deptno, ROW_NUMBER() over (partition by ename order by deptno) as row_num FROM emp QUALIFY row_num = 1"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKhAIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QS1wESBWVtcG5vEgVlbmFtZRIGZGVwdG5vEgdyb3dfbnVtGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBAHGmgyZgoCEAUSDAoKUk9XX05VTUJFUiJSCjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAESDAoKEggKBAgBEAQQBxoEGgIIASICEgAoAQrkAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBK3AQgBEgVlbXBubxIFZW5hbWUSBmRlcHRubxIHcm93X251bRIRUXVhbGlmeUV4cHJlc3Npb24aCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAIaCBIGCgIQBRADGikqJwoCEAESCAoGRVFVQUxTGggSBgoCEAUQAxoNIgsKAhAFEgMSAQFQBgo3Cid0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxGaWx0ZXISDBACGggSBgoCEAEQBAqlAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJ5CAMSBWVtcG5vEgVlbmFtZRIGZGVwdG5vEgdyb3dfbnVtGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBACGggSBgoCEAUQAw=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A 84 02 0A 28 74 79 70 65 2E 67 ..EMP....(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 D7 01 12 05 65 6D 70 6E 6F 12 05 65 6E ct.×...empno..en"
     - "00000070 61 6D 65 12 06 64 65 70 74 6E 6F 12 07 72 6F 77 ame..deptno..row"
     - "00000080 5F 6E 75 6D 1A 08 12 06 0A 04 08 01 10 04 1A 36 _num...........6"
     - "00000090 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 .4.0.... .*...IS"
     - "000000A0 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "000000B0 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "000000C0 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 59-1............"
     - "000000D0 10 07 1A 68 32 66 0A 02 10 05 12 0C 0A 0A 52 4F ...h2f........RO"
     - "000000E0 57 5F 4E 55 4D 42 45 52 22 52 0A 36 12 34 0A 30 W_NUMBER\"R.6.4.0"
     - "000000F0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "00000100 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "00000110 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "00000120 10 01 12 0C 0A 0A 12 08 0A 04 08 01 10 04 10 07 ................"
     - "00000130 1A 04 1A 02 08 01 22 02 12 00 28 01 0A E4 01 0A ......\"...(..ä.."
     - "00000140 28 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 (type.googleapis"
     - "00000150 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 .com/plan.PLogic"
     - "00000160 61 6C 50 72 6F 6A 65 63 74 12 B7 01 08 01 12 05 alProject.·....."
     - "00000170 65 6D 70 6E 6F 12 05 65 6E 61 6D 65 12 06 64 65 empno..ename..de"
     - "00000180 70 74 6E 6F 12 07 72 6F 77 5F 6E 75 6D 12 11 51 ptno..row_num..Q"
     - "00000190 75 61 6C 69 66 79 45 78 70 72 65 73 73 69 6F 6E ualifyExpression"
     - "000001A0 1A 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 ...........6.4.0"
     - "000001B0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "000001C0 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "000001D0 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "000001E0 10 01 1A 0A 12 08 0A 04 08 01 10 04 10 02 1A 08 ................"
     - "000001F0 12 06 0A 02 10 05 10 03 1A 29 2A 27 0A 02 10 01 .........)*'...."
     - "00000200 12 08 0A 06 45 51 55 41 4C 53 1A 08 12 06 0A 02 ....EQUALS......"
     - "00000210 10 05 10 03 1A 0D 22 0B 0A 02 10 05 12 03 12 01 ......\"........."
     - "00000220 01 50 06 0A 37 0A 27 74 79 70 65 2E 67 6F 6F 67 .P..7.'type.goog"
     - "00000230 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E leapis.com/plan."
     - "00000240 50 4C 6F 67 69 63 61 6C 46 69 6C 74 65 72 12 0C PLogicalFilter.."
     - "00000250 10 02 1A 08 12 06 0A 02 10 01 10 04 0A A5 01 0A .............¥.."
     - "00000260 28 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 (type.googleapis"
     - "00000270 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 .com/plan.PLogic"
     - "00000280 61 6C 50 72 6F 6A 65 63 74 12 79 08 03 12 05 65 alProject.y....e"
     - "00000290 6D 70 6E 6F 12 05 65 6E 61 6D 65 12 06 64 65 70 mpno..ename..dep"
     - "000002A0 74 6E 6F 12 07 72 6F 77 5F 6E 75 6D 1A 08 12 06 tno..row_num...."
     - "000002B0 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D .......6.4.0...."
     - "000002C0 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31  .*...ISO-8859-1"
     - "000002D0 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 $en_US$primary(."
     - "000002E0 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 2.ISO-8859-1...."
     - "000002F0 12 08 0A 04 08 01 10 04 10 02 1A 08 12 06 0A 02 ................"
     - "00000300 10 05 10 03                                     ...."
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2], row_num=[$3])"
     - "  LogicalFilter(condition=[$4])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$2], row_num=[$3], QualifyExpression=[=($3, 1)])"
     - "      LogicalProject(empno=[$0], ename=[$1], deptno=[$7], row_num=[ROW_NUMBER() OVER (PARTITION BY $1 ORDER BY $7 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])"
     - "        LogicalTableScan(table=[[EMP]])"
 -
  description: "QUALIFY WITH DERIVED COLUMN"
  input: "SELECT empno, ename, deptno, SUBSTRING(ename, 1, 1) as derived_column FROM emp QUALIFY ROW_NUMBER() over (partition by derived_column order by deptno) = 1"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKwgQKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSlQQSBWVtcG5vEgVlbmFtZRIGZGVwdG5vEg5kZXJpdmVkX2NvbHVtbhIRUXVhbGlmeUV4cHJlc3Npb24aCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAcamAEqlQEKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRILCglTVUJTVFJJTkcaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoNIgsKAhAEEgMSAQFQBhoNIgsKAhAEEgMSAQFQBhrwASrtAQoCEAESCAoGRVFVQUxTGs0BMsoBCgIQBRIMCgpST1dfTlVNQkVSIrUBCpgBKpUBCjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTESCwoJU1VCU1RSSU5HGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaDSILCgIQBBIDEgEBUAYaDSILCgIQBBIDEgEBUAYSDAoKEggKBAgBEAQQBxoEGgIIASICEgAoARoNIgsKAhAFEgMSAQFQBgo3Cid0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxGaWx0ZXISDBABGggSBgoCEAEQBArbAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBKuAQgCEgVlbXBubxIFZW5hbWUSBmRlcHRubxIOZGVyaXZlZF9jb2x1bW4aCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAIaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQAw=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A C2 04 0A 28 74 79 70 65 2E 67 ..EMP.Â..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 95 04 12 05 65 6D 70 6E 6F 12 05 65 6E ct.....empno..en"
     - "00000070 61 6D 65 12 06 64 65 70 74 6E 6F 12 0E 64 65 72 ame..deptno..der"
     - "00000080 69 76 65 64 5F 63 6F 6C 75 6D 6E 12 11 51 75 61 ived_column..Qua"
     - "00000090 6C 69 66 79 45 78 70 72 65 73 73 69 6F 6E 1A 08 lifyExpression.."
     - "000000A0 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 .........6.4.0.."
     - "000000B0 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "000000C0 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "000000D0 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 (.2.ISO-8859-1.."
     - "000000E0 1A 0A 12 08 0A 04 08 01 10 04 10 07 1A 98 01 2A ...............*"
     - "000000F0 95 01 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 ...0.... .*...IS"
     - "00000100 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "00000110 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "00000120 35 39 2D 31 12 0B 0A 09 53 55 42 53 54 52 49 4E 59-1....SUBSTRIN"
     - "00000130 47 1A 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A G.6.4.0.... .*.."
     - "00000140 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 .ISO-8859-1$en_U"
     - "00000150 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 4F S$primary(.2.ISO"
     - "00000160 2D 38 38 35 39 2D 31 10 01 1A 0D 22 0B 0A 02 10 -8859-1....\"...."
     - "00000170 04 12 03 12 01 01 50 06 1A 0D 22 0B 0A 02 10 04 ......P...\"....."
     - "00000180 12 03 12 01 01 50 06 1A F0 01 2A ED 01 0A 02 10 .....P..ð.*í...."
     - "00000190 01 12 08 0A 06 45 51 55 41 4C 53 1A CD 01 32 CA .....EQUALS.Í.2Ê"
     - "000001A0 01 0A 02 10 05 12 0C 0A 0A 52 4F 57 5F 4E 55 4D .........ROW_NUM"
     - "000001B0 42 45 52 22 B5 01 0A 98 01 2A 95 01 0A 30 08 01 BER\"µ....*...0.."
     - "000001C0 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "000001D0 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "000001E0 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 12 0B (.2.ISO-8859-1.."
     - "000001F0 0A 09 53 55 42 53 54 52 49 4E 47 1A 36 12 34 0A ..SUBSTRING.6.4."
     - "00000200 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 0.... .*...ISO-8"
     - "00000210 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 859-1$en_US$prim"
     - "00000220 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D ary(.2.ISO-8859-"
     - "00000230 31 10 01 1A 0D 22 0B 0A 02 10 04 12 03 12 01 01 1....\".........."
     - "00000240 50 06 1A 0D 22 0B 0A 02 10 04 12 03 12 01 01 50 P...\"..........P"
     - "00000250 06 12 0C 0A 0A 12 08 0A 04 08 01 10 04 10 07 1A ................"
     - "00000260 04 1A 02 08 01 22 02 12 00 28 01 1A 0D 22 0B 0A .....\"...(...\".."
     - "00000270 02 10 05 12 03 12 01 01 50 06 0A 37 0A 27 74 79 ........P..7.'ty"
     - "00000280 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 2E 63 6F pe.googleapis.co"
     - "00000290 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 61 6C 46 m/plan.PLogicalF"
     - "000002A0 69 6C 74 65 72 12 0C 10 01 1A 08 12 06 0A 02 10 ilter..........."
     - "000002B0 01 10 04 0A DB 01 0A 28 74 79 70 65 2E 67 6F 6F ....Û..(type.goo"
     - "000002C0 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E gleapis.com/plan"
     - "000002D0 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 .PLogicalProject"
     - "000002E0 12 AE 01 08 02 12 05 65 6D 70 6E 6F 12 05 65 6E .®.....empno..en"
     - "000002F0 61 6D 65 12 06 64 65 70 74 6E 6F 12 0E 64 65 72 ame..deptno..der"
     - "00000300 69 76 65 64 5F 63 6F 6C 75 6D 6E 1A 08 12 06 0A ived_column....."
     - "00000310 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D 20 ......6.4.0.... "
     - "00000320 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 .*...ISO-8859-1$"
     - "00000330 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 en_US$primary(.2"
     - "00000340 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 12 .ISO-8859-1....."
     - "00000350 08 0A 04 08 01 10 04 10 02 1A 36 12 34 0A 30 08 ..........6.4.0."
     - "00000360 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 ... .*...ISO-885"
     - "00000370 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 9-1$en_US$primar"
     - "00000380 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 y(.2.ISO-8859-1."
     - "00000390 03                                              ."
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2], derived_column=[$3])"
     - "  LogicalFilter(condition=[$4])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$7], derived_column=[SUBSTRING($1, 1, 1)], QualifyExpression=[=(ROW_NUMBER() OVER (PARTITION BY SUBSTRING($1, 1, 1) ORDER BY $7 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 1)])"
     - "      LogicalTableScan(table=[[EMP]])"
 -
  description: "QUALIFY WITH WINDOW CLAUSE"
  input: "SELECT empno, ename, deptno, ROW_NUMBER() over myWindow as row_num FROM emp WINDOW myWindow AS (PARTITION BY ename ORDER BY deptno) QUALIFY row_num = 1"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKhAIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QS1wESBWVtcG5vEgVlbmFtZRIGZGVwdG5vEgdyb3dfbnVtGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBAHGmgyZgoCEAUSDAoKUk9XX05VTUJFUiJSCjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAESDAoKEggKBAgBEAQQBxoEGgIIASICEgAoAQrkAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBK3AQgBEgVlbXBubxIFZW5hbWUSBmRlcHRubxIHcm93X251bRIRUXVhbGlmeUV4cHJlc3Npb24aCBIGCgQIARAEGjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAEaChIICgQIARAEEAIaCBIGCgIQBRADGikqJwoCEAESCAoGRVFVQUxTGggSBgoCEAUQAxoNIgsKAhAFEgMSAQFQBgo3Cid0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxGaWx0ZXISDBACGggSBgoCEAEQBAqlAQoodHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsUHJvamVjdBJ5CAMSBWVtcG5vEgVlbmFtZRIGZGVwdG5vEgdyb3dfbnVtGggSBgoECAEQBBo2EjQKMAgBEB0gFCocChhJU08tODg1OS0xJGVuX1VTJHByaW1hcnkoAjIKSVNPLTg4NTktMRABGgoSCAoECAEQBBACGggSBgoCEAUQAw=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A 84 02 0A 28 74 79 70 65 2E 67 ..EMP....(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 D7 01 12 05 65 6D 70 6E 6F 12 05 65 6E ct.×...empno..en"
     - "00000070 61 6D 65 12 06 64 65 70 74 6E 6F 12 07 72 6F 77 ame..deptno..row"
     - "00000080 5F 6E 75 6D 1A 08 12 06 0A 04 08 01 10 04 1A 36 _num...........6"
     - "00000090 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 .4.0.... .*...IS"
     - "000000A0 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "000000B0 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "000000C0 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 59-1............"
     - "000000D0 10 07 1A 68 32 66 0A 02 10 05 12 0C 0A 0A 52 4F ...h2f........RO"
     - "000000E0 57 5F 4E 55 4D 42 45 52 22 52 0A 36 12 34 0A 30 W_NUMBER\"R.6.4.0"
     - "000000F0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "00000100 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "00000110 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "00000120 10 01 12 0C 0A 0A 12 08 0A 04 08 01 10 04 10 07 ................"
     - "00000130 1A 04 1A 02 08 01 22 02 12 00 28 01 0A E4 01 0A ......\"...(..ä.."
     - "00000140 28 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 (type.googleapis"
     - "00000150 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 .com/plan.PLogic"
     - "00000160 61 6C 50 72 6F 6A 65 63 74 12 B7 01 08 01 12 05 alProject.·....."
     - "00000170 65 6D 70 6E 6F 12 05 65 6E 61 6D 65 12 06 64 65 empno..ename..de"
     - "00000180 70 74 6E 6F 12 07 72 6F 77 5F 6E 75 6D 12 11 51 ptno..row_num..Q"
     - "00000190 75 61 6C 69 66 79 45 78 70 72 65 73 73 69 6F 6E ualifyExpression"
     - "000001A0 1A 08 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 ...........6.4.0"
     - "000001B0 08 01 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 .... .*...ISO-88"
     - "000001C0 35 39 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 59-1$en_US$prima"
     - "000001D0 72 79 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 ry(.2.ISO-8859-1"
     - "000001E0 10 01 1A 0A 12 08 0A 04 08 01 10 04 10 02 1A 08 ................"
     - "000001F0 12 06 0A 02 10 05 10 03 1A 29 2A 27 0A 02 10 01 .........)*'...."
     - "00000200 12 08 0A 06 45 51 55 41 4C 53 1A 08 12 06 0A 02 ....EQUALS......"
     - "00000210 10 05 10 03 1A 0D 22 0B 0A 02 10 05 12 03 12 01 ......\"........."
     - "00000220 01 50 06 0A 37 0A 27 74 79 70 65 2E 67 6F 6F 67 .P..7.'type.goog"
     - "00000230 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E leapis.com/plan."
     - "00000240 50 4C 6F 67 69 63 61 6C 46 69 6C 74 65 72 12 0C PLogicalFilter.."
     - "00000250 10 02 1A 08 12 06 0A 02 10 01 10 04 0A A5 01 0A .............¥.."
     - "00000260 28 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 73 (type.googleapis"
     - "00000270 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 63 .com/plan.PLogic"
     - "00000280 61 6C 50 72 6F 6A 65 63 74 12 79 08 03 12 05 65 alProject.y....e"
     - "00000290 6D 70 6E 6F 12 05 65 6E 61 6D 65 12 06 64 65 70 mpno..ename..dep"
     - "000002A0 74 6E 6F 12 07 72 6F 77 5F 6E 75 6D 1A 08 12 06 tno..row_num...."
     - "000002B0 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 10 1D .......6.4.0...."
     - "000002C0 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31  .*...ISO-8859-1"
     - "000002D0 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 28 02 $en_US$primary(."
     - "000002E0 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 2.ISO-8859-1...."
     - "000002F0 12 08 0A 04 08 01 10 04 10 02 1A 08 12 06 0A 02 ................"
     - "00000300 10 05 10 03                                     ...."
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2], row_num=[$3])"
     - "  LogicalFilter(condition=[$4])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$2], row_num=[$3], QualifyExpression=[=($3, 1)])"
     - "      LogicalProject(empno=[$0], ename=[$1], deptno=[$7], row_num=[ROW_NUMBER() OVER (PARTITION BY $1 ORDER BY $7 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)])"
     - "        LogicalTableScan(table=[[EMP]])"
 -
  description: "QUALIFY IN SUBQUERY"
  input: "SELECT * FROM ( SELECT DISTINCT empno, ename, deptno  FROM emp  QUALIFY RANK() OVER (PARTITION BY ename ORDER BY deptno DESC) = 1 )"
  output:
    queryPlanBinary: "CjMKKnR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFRhYmxlU2NhbhIFCgNFTVAKrAIKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QS/wESBWVtcG5vEgVlbmFtZRIGZGVwdG5vEhFRdWFsaWZ5RXhwcmVzc2lvbhoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQBxqFASqCAQoCEAESCAoGRVFVQUxTGmMyYQoCEAUSBgoEUkFOSyJTCjYSNAowCAEQHSAUKhwKGElTTy04ODU5LTEkZW5fVVMkcHJpbWFyeSgCMgpJU08tODg1OS0xEAESDwoKEggKBAgBEAQQByIBARoEGgIIASICEgAaDSILCgIQBRIDEgEBUAYKNwondHlwZS5nb29nbGVhcGlzLmNvbS9wbGFuLlBMb2dpY2FsRmlsdGVyEgwQARoIEgYKAhABEAMKkgEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSZggCEgVlbXBubxIFZW5hbWUSBmRlcHRubxoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQAgo+Cip0eXBlLmdvb2dsZWFwaXMuY29tL3BsYW4uUExvZ2ljYWxBZ2dyZWdhdGUSEAgDIgUKAwABAioFCgMAAQIKkgEKKHR5cGUuZ29vZ2xlYXBpcy5jb20vcGxhbi5QTG9naWNhbFByb2plY3QSZggEEgVlbXBubxIFZW5hbWUSBmRlcHRubxoIEgYKBAgBEAQaNhI0CjAIARAdIBQqHAoYSVNPLTg4NTktMSRlbl9VUyRwcmltYXJ5KAIyCklTTy04ODU5LTEQARoKEggKBAgBEAQQAg=="
    queryPlanBinaryHexDump:
     - "00000000 0A 33 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C 65 61 .3.*type.googlea"
     - "00000010 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F pis.com/plan.PLo"
     - "00000020 67 69 63 61 6C 54 61 62 6C 65 53 63 61 6E 12 05 gicalTableScan.."
     - "00000030 0A 03 45 4D 50 0A AC 02 0A 28 74 79 70 65 2E 67 ..EMP.¬..(type.g"
     - "00000040 6F 6F 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C oogleapis.com/pl"
     - "00000050 61 6E 2E 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 an.PLogicalProje"
     - "00000060 63 74 12 FF 01 12 05 65 6D 70 6E 6F 12 05 65 6E ct.....empno..en"
     - "00000070 61 6D 65 12 06 64 65 70 74 6E 6F 12 11 51 75 61 ame..deptno..Qua"
     - "00000080 6C 69 66 79 45 78 70 72 65 73 73 69 6F 6E 1A 08 lifyExpression.."
     - "00000090 12 06 0A 04 08 01 10 04 1A 36 12 34 0A 30 08 01 .........6.4.0.."
     - "000000A0 10 1D 20 14 2A 1C 0A 18 49 53 4F 2D 38 38 35 39 .. .*...ISO-8859"
     - "000000B0 2D 31 24 65 6E 5F 55 53 24 70 72 69 6D 61 72 79 -1$en_US$primary"
     - "000000C0 28 02 32 0A 49 53 4F 2D 38 38 35 39 2D 31 10 01 (.2.ISO-8859-1.."
     - "000000D0 1A 0A 12 08 0A 04 08 01 10 04 10 07 1A 85 01 2A ...............*"
     - "000000E0 82 01 0A 02 10 01 12 08 0A 06 45 51 55 41 4C 53 ..........EQUALS"
     - "000000F0 1A 63 32 61 0A 02 10 05 12 06 0A 04 52 41 4E 4B .c2a........RANK"
     - "00000100 22 53 0A 36 12 34 0A 30 08 01 10 1D 20 14 2A 1C \"S.6.4.0.... .*."
     - "00000110 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E 5F ..ISO-8859-1$en_"
     - "00000120 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 53 US$primary(.2.IS"
     - "00000130 4F 2D 38 38 35 39 2D 31 10 01 12 0F 0A 0A 12 08 O-8859-1........"
     - "00000140 0A 04 08 01 10 04 10 07 22 01 01 1A 04 1A 02 08 ........\"......."
     - "00000150 01 22 02 12 00 1A 0D 22 0B 0A 02 10 05 12 03 12 .\".....\"........"
     - "00000160 01 01 50 06 0A 37 0A 27 74 79 70 65 2E 67 6F 6F ..P..7.'type.goo"
     - "00000170 67 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E gleapis.com/plan"
     - "00000180 2E 50 4C 6F 67 69 63 61 6C 46 69 6C 74 65 72 12 .PLogicalFilter."
     - "00000190 0C 10 01 1A 08 12 06 0A 02 10 01 10 03 0A 92 01 ................"
     - "000001A0 0A 28 74 79 70 65 2E 67 6F 6F 67 6C 65 61 70 69 .(type.googleapi"
     - "000001B0 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 4C 6F 67 69 s.com/plan.PLogi"
     - "000001C0 63 61 6C 50 72 6F 6A 65 63 74 12 66 08 02 12 05 calProject.f...."
     - "000001D0 65 6D 70 6E 6F 12 05 65 6E 61 6D 65 12 06 64 65 empno..ename..de"
     - "000001E0 70 74 6E 6F 1A 08 12 06 0A 04 08 01 10 04 1A 36 ptno...........6"
     - "000001F0 12 34 0A 30 08 01 10 1D 20 14 2A 1C 0A 18 49 53 .4.0.... .*...IS"
     - "00000200 4F 2D 38 38 35 39 2D 31 24 65 6E 5F 55 53 24 70 O-8859-1$en_US$p"
     - "00000210 72 69 6D 61 72 79 28 02 32 0A 49 53 4F 2D 38 38 rimary(.2.ISO-88"
     - "00000220 35 39 2D 31 10 01 1A 0A 12 08 0A 04 08 01 10 04 59-1............"
     - "00000230 10 02 0A 3E 0A 2A 74 79 70 65 2E 67 6F 6F 67 6C ...>.*type.googl"
     - "00000240 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E 50 eapis.com/plan.P"
     - "00000250 4C 6F 67 69 63 61 6C 41 67 67 72 65 67 61 74 65 LogicalAggregate"
     - "00000260 12 10 08 03 22 05 0A 03 00 01 02 2A 05 0A 03 00 ....\"......*...."
     - "00000270 01 02 0A 92 01 0A 28 74 79 70 65 2E 67 6F 6F 67 ......(type.goog"
     - "00000280 6C 65 61 70 69 73 2E 63 6F 6D 2F 70 6C 61 6E 2E leapis.com/plan."
     - "00000290 50 4C 6F 67 69 63 61 6C 50 72 6F 6A 65 63 74 12 PLogicalProject."
     - "000002A0 66 08 04 12 05 65 6D 70 6E 6F 12 05 65 6E 61 6D f....empno..enam"
     - "000002B0 65 12 06 64 65 70 74 6E 6F 1A 08 12 06 0A 04 08 e..deptno......."
     - "000002C0 01 10 04 1A 36 12 34 0A 30 08 01 10 1D 20 14 2A ....6.4.0.... .*"
     - "000002D0 1C 0A 18 49 53 4F 2D 38 38 35 39 2D 31 24 65 6E ...ISO-8859-1$en"
     - "000002E0 5F 55 53 24 70 72 69 6D 61 72 79 28 02 32 0A 49 _US$primary(.2.I"
     - "000002F0 53 4F 2D 38 38 35 39 2D 31 10 01 1A 0A 12 08 0A SO-8859-1......."
     - "00000300 04 08 01 10 04 10 02                            ......."
    queryPlanText:
     - "LogicalProject(empno=[$0], ename=[$1], deptno=[$2])"
     - "  LogicalAggregate(group=[{0, 1, 2}])"
     - "    LogicalProject(empno=[$0], ename=[$1], deptno=[$2])"
     - "      LogicalFilter(condition=[$3])"
     - "        LogicalProject(empno=[$0], ename=[$1], deptno=[$7], QualifyExpression=[=(RANK() OVER (PARTITION BY $1 ORDER BY $7 DESC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW), 1)])"
     - "          LogicalTableScan(table=[[EMP]])"
